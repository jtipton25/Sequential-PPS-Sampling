x <- perm.mat[i, 1:k]
fn <- ecdf(x)
p[i, k] <- fn(x)[k]
}
}
N <- 4
perm.mat <- rbind(1:N, allPerms(N))
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
for(i in 1:dim(perm.mat)[1]){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, k] <- fn(x)[k]
}
}
pi
apply(pi, 2, mean)
perm.mat
pi[i, ][perm.mat[i,]]
library(permute)
N <- 4
perm.mat <- rbind(1:N, allPerms(N))
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
for(i in 1:dim(perm.mat)[1]){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, k] <- fn(x)[k]
}
pi[i,] <- pi[i, ][perm.mat[i,]]
}
apply(pi, 2, mean)
perm.mat[i,]
pi[i, ]
pi[i, ][perm.mat[i,]]
i=1
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, k] <- fn(x)[k]
}
perm.mat[i,]
pi[i, ]
pi[i,] <- pi[i, ][perm.mat[i,]]
pi[1,]
i=2
perm.mat[i,]]
perm.mat[i,]
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, k] <- fn(x)[k]
}
pi[i, ]
pi[i, ][perm.mat[i,]]
pi[i,] <- pi[i, ][perm.mat[i,]]
i=3
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, k] <- fn(x)[k]
}
pi[i, ]
perm.mat[i,]
pi[i, ][perm.mat[i,]]
N <- 4
perm.mat <- rbind(1:N, allPerms(N))
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
for(i in 1:dim(perm.mat)[1]){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, k] <- fn(x)[k]
}
pi[i,] <- pi[i, ][perm.mat[i,]]
}
pi
i=23
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, k] <- fn(x)[k]
}
perm.mat[i,]
pi[i, ]
pi[i, ][perm.mat[i,]]
perm.mat[i,k]
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
pi[23,]
N <- 4
perm.mat <- rbind(1:N, allPerms(N))
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
for(i in 1:dim(perm.mat)[1]){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
pi
apply(pi, 2, mean)
75/144
98/144
121/144
N <- 100
perm.mat <- rbind(1:N, allPerms(N))
?maxperm
perm.mat <- rbind(1:N, allPerms(N, maxperm=9999))
?allPerms
observed = FALSE)
h <- how(within = Within(), plots = Plots(), blocks = NULL,
nperm = 199, complete = FALSE, maxperm = 9999,
minperm = 99, all.perms = NULL, make = TRUE,
observed = FALSE)
h <- how(within = Within(), plots = Plots(), blocks = NULL,
nperm = 199, complete = FALSE, maxperm = 9999,
minperm = 99, all.perms = NULL, make = TRUE,
observed = FALSE)
perm.mat <- rbind(1:N, allPerms(N))
getMaxperm(control)
?getMaxperm
N <- 10
perm.mat <- rbind(1:N, allPerms(N))
N <- 8
perm.mat <- rbind(1:N, allPerms(N))
N <- 6
perm.mat <- rbind(1:N, allPerms(N))
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
for(i in 1:dim(perm.mat)[1]){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
apply(pi, 2, mean)
pi
N <- 7
perm.mat <- rbind(1:N, allPerms(N))
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
for(i in 1:dim(perm.mat)[1]){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
apply(pi, 2, mean)
dim(pi)
N <- 8
perm.mat <- rbind(1:N, allPerms(N))
ctrl <- how(maxperm = 100000)
perm.mat <- rbind(1:N, allPerms(N, control = ctrl))
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
for(i in 1:dim(perm.mat)[1]){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
apply(pi, 2, mean)
wrapper <- function(i){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
sfExportAll()
library(snowfall)
sfExportAll()
library(parallel)
cps <- detectCores()
SfInit(parallel = TRUE, cpus = cps)
sfInit(parallel = TRUE, cpus = cps)
sfExportAll()
pi.test <- sfSapply(1:dim(perm.mat)[2], wrapper)
pi.test
N <- 2
perm.mat <- rbind(1:N, allPerms(N, control = ctrl))
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
for(i in 1:dim(perm.mat)[1]){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
apply(pi, 2, mean)
wrapper <- function(i){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
pi[i, ]
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
library(snowfall)
library(parallel)
cps <- detectCores()
sfInit(parallel = TRUE, cpus = cps)
sfExportAll()
pi.test <- sfSapply(1:dim(perm.mat)[2], wrapper)
pi.test
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
for(i in 1:dim(perm.mat)[1]){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
pi
pi.test <- sfSapply(1:dim(perm.mat)[1], wrapper)
pi.test
wrapper <- function(i){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
return(pi[i, ])
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
library(snowfall)
library(parallel)
cps <- detectCores()
sfInit(parallel = TRUE, cpus = cps)
sfExportAll()
pi.test <- sfSapply(1:dim(perm.mat)[1], wrapper)
pi.test
N <- 3
perm.mat <- rbind(1:N, allPerms(N, control = ctrl))
wrapper <- function(i){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
return(pi[i, ])
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
library(snowfall)
library(parallel)
sfExportAll()
pi.test <- sfSapply(1:dim(perm.mat)[1], wrapper)
pi.test
pi.test <- sfSapply(1:dim(perm.mat)[2], wrapper)
pi.test
dim(perm.mat)[2]
dim(perm.mat)[1]
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
sfExportAll()
pi.test <- sfSapply(1:dim(perm.mat)[1], wrapper)
pi.test
wrapper <- function(i){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
pi[i, ]
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
sfExportAll()
pi.test <- sfSapply(1:dim(perm.mat)[1], wrapper)
pi.test
library(permute)
ctrl <- how(maxperm = 100000)
N <- 3
perm.mat <- rbind(1:N, allPerms(N, control = ctrl))
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
for(i in 1:dim(perm.mat)[1]){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
apply(pi, 2, mean)
N <- 10
perm.mat <- rbind(1:N, allPerms(N, control = ctrl))
ctrl <- how(maxperm = 10000000)
N <- 10
perm.mat <- rbind(1:N, allPerms(N, control = ctrl))
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
for(i in 1:dim(perm.mat)[1]){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
N <- 5
perm.mat <- rbind(1:N, allPerms(N, control = ctrl))
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
for(i in 1:dim(perm.mat)[1]){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
apply(pi, 2, mean)
library(MASS)
as.fractions(apply(pi, 2, mean))
137*4
237*2
237*3
437*2
548/1200
137*4
237*3
437*2
as.fractions(apply(pi, 2, mean))
## N = 5, denominator of 1200
137*4
237*3
437*2
1/5
1200/5
240/1200
960/1200
548-240
137*4 - 240
237*3 - 240 * 2
437*2 - 240 * 3
1037 - 240 * 4
N <- 6
perm.mat <- rbind(1:N, allPerms(N, control = ctrl))
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
for(i in 1:dim(perm.mat)[1]){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
apply(pi, 2, mean)
as.fractions(apply(pi, 2, mean))
49*5
79*4
129*3
229*2
145/600
1/4
library(permute)
library(MASS)
ctrl <- how(maxperm = 10000000)
N <- 6
perm.mat <- rbind(1:N, allPerms(N, control = ctrl))
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
for(i in 1:dim(perm.mat)[1]){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
apply(pi, 2, mean)
as.fractions(apply(pi, 2, mean))
N <- 7
perm.mat <- rbind(1:N, allPerms(N, control = ctrl))
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
for(i in 1:dim(perm.mat)[1]){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
apply(pi, 2, mean)
as.fractions(apply(pi, 2, mean))
5880/980
1176*5
1960*3
363*6
559*5
300*4
1343*3
2323*2
5880/7
363*6
559*5
300*4
1343*3
2323*2
as.fractions(apply(pi, 2, mean))
300*8
5880/517
5880/1176
1343*3
2323*2
363*6 - 840
840*2
559*5 - 840*2
840*3
300*4 - 840*3
840*4
1343*3 - 840*4
840*5
2323*2 - 840*5
5263 - 840*6
669+223
892+223
892/5880 + 300/517
as.fraction(892/5880 + 300/517)
as.fractions(892/5880 + 300/517)
8550/832
is.prime(517)
517*5880
divisors(3039960)
as.fractions(apply(pi, 2, mean))
517/3
517/7
517/5
517/9
517/11
517/3
11*47
5880/11
5880/47
5880*517
## N = 7 denominator of 3039960
363*6*517
559*5*517
## 517 has divisors of 11 and 47
## 5880
300*5880
1343*3*517
2323*2*517
363*6*517
559*5*517
## 517 has divisors of 11 and 47
## 5880
300*5880
1343*3*517
2323*2*517
as.fractions(apply(pi, 2, mean))
1343*3*517
2323*2*517
5263*517
363*6*517 - 840*517
840*517
840*517/3039960
1/7
840*517
363*6*517 - 840*517
691746-434280
363*6*517 - 840*517
363*6*517
840*2*517
559*5 - 840*2*517
559*5*517 - 840*2*517
300*4*517 - 840*3*517
300*5880 - 840*3*517
1343*3*517 - 840*4*517
2323*2*517 - 840*5*517
5263*517 - 840*6*517
840*6*517
840*5*517
840*4*517
840*3*517
840*2*517
factorial(4)
factorial(4)*4
factorial(3)*3
factorial(3)^2
factorial(4)^2
factorial(4)^2/4
factorial(5)^2
14400/1200
factorial(6)^2
518400/600
factorial(7)^2
factorial(7)^2 / 3039960
ctrl <- how(maxperm = 10000000)
N <- 7
perm.mat <- rbind(1:N, allPerms(N, control = ctrl))
pi <- matrix(nrow = dim(perm.mat)[1], ncol = dim(perm.mat)[2])
for(i in 1:dim(perm.mat)[1]){
for(k in 1:dim(perm.mat)[2]){
x <- perm.mat[i, 1:k]
fn <- ecdf(x)
pi[i, perm.mat[i,k]] <- fn(x)[k]
}
#	pi[i,] <- pi[i, ][perm.mat[i,]]
}
apply(pi, 2, mean)
as.fractions(apply(pi, 2, mean))
517*5880
factorial(7)^2
